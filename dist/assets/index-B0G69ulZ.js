(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();const d=800,a=600,i=5,l=6,c=.02;class m{constructor(){this.bee={x:300,y:400,width:48,height:48,element:document.getElementById("bee")},this.hearts=[],this.flowers=[],this.score=0,this.gameOver=!1,this.keysPressed=new Set,this.lastShot=0,this.birthdayShown=!1,this.backgroundMusic=new Audio("sounds/fondo.mp3"),this.birthdaySound=new Audio("sounds/birthday.mp3"),this.backgroundMusic.loop=!0,this.backgroundMusic.volume=.5,this.setupEventListeners(),this.gameLoop()}setupEventListeners(){document.addEventListener("keydown",e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&(e.preventDefault(),this.keysPressed.add(e.key))}),document.addEventListener("keyup",e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&(e.preventDefault(),this.keysPressed.delete(e.key))})}updateBeePosition(){this.keysPressed.has("ArrowLeft")&&(this.bee.x-=i),this.keysPressed.has("ArrowRight")&&(this.bee.x+=i),this.keysPressed.has("ArrowUp")&&(this.bee.y-=i),this.keysPressed.has("ArrowDown")&&(this.bee.y+=i),this.bee.x=Math.max(0,Math.min(d-this.bee.width,this.bee.x)),this.bee.y=Math.max(0,Math.min(a-this.bee.height,this.bee.y)),this.bee.element.style.transform=`translate(${this.bee.x}px, ${this.bee.y}px)`}shootHeart(){const e=Date.now();if(this.keysPressed.has(" ")&&e-this.lastShot>250){const t=document.createElement("div");t.className="heart",t.style.transform=`translate(${this.bee.x+24}px, ${this.bee.y}px)`,document.getElementById("gameContainer").appendChild(t),this.hearts.push({x:this.bee.x+24,y:this.bee.y,width:20,height:20,element:t}),this.lastShot=e}}updateHearts(){for(let e=this.hearts.length-1;e>=0;e--){const t=this.hearts[e];t.y-=l,t.element.style.transform=`translate(${t.x}px, ${t.y}px)`,t.y<-20&&(t.element.remove(),this.hearts.splice(e,1))}}spawnFlower(){if(Math.random()<c){const e=document.createElement("div");e.className="flower";for(let s=0;s<4;s++){const n=document.createElement("div");n.className="petal",e.appendChild(n)}const t=document.createElement("div");t.className="flower-center",e.appendChild(t);const r=Math.random()*(d-40);e.style.transform=`translate(${r}px, -40px)`,document.getElementById("gameContainer").appendChild(e),this.flowers.push({x:r,y:-40,width:40,height:40,speed:1+Math.random(),element:e})}}updateFlowers(){for(let e=this.flowers.length-1;e>=0;e--){const t=this.flowers[e];if(t.y+=t.speed,t.element.style.transform=`translate(${t.x}px, ${t.y}px)`,this.isColliding(this.bee,t)){this.endGame();return}}}checkCollisions(){for(let e=this.hearts.length-1;e>=0;e--){const t=this.hearts[e];for(let r=this.flowers.length-1;r>=0;r--){const s=this.flowers[r];if(this.isColliding(t,s)){t.element.remove(),this.hearts.splice(e,1),s.element.remove(),this.flowers.splice(r,1),this.updateScore(100);break}}}}isColliding(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}updateScore(e){if(this.score+=e,document.getElementById("score").textContent=`Score: ${this.score}`,this.score>=1e3&&!this.birthdayShown){this.showBirthdayMessage(),this.birthdayShown=!0,this.gameOver=!0,this.cleanGameElements(),this.backgroundMusic.pause(),this.birthdaySound.play();const t=d/2,r=a/2;for(let s=0;s<135;s++)setTimeout(()=>this.generateFireworks(t,r),s*500)}}cleanGameElements(){document.querySelectorAll(".heart, .flower").forEach(e=>e.remove())}showBirthdayMessage(){const e=document.createElement("div");e.className="birthday-message",e.innerHTML="Â¡Feliz CumpleaÃ±os Wendy! ðŸŽ‚âœ¨",document.getElementById("gameContainer").appendChild(e),setTimeout(()=>{},3e3)}endGame(){this.gameOver=!0,this.backgroundMusic.pause(),document.getElementById("finalScore").textContent=this.score,document.getElementById("gameOver").style.display="flex"}gameLoop(){this.gameOver||(this.backgroundMusic.play(),this.updateBeePosition(),this.shootHeart(),this.updateHearts(),this.spawnFlower(),this.updateFlowers(),this.checkCollisions(),requestAnimationFrame(()=>this.gameLoop()))}generateFireworks(e,t){for(let r=0;r<20;r++){const s=document.createElement("div");s.className="firework",s.style.left=`${e}px`,s.style.top=`${t}px`;const n=Math.random()*2*Math.PI,o=Math.random()*.5+.5;s.style.setProperty("--dx",Math.cos(n)*o),s.style.setProperty("--dy",Math.sin(n)*o),document.getElementById("gameContainer").appendChild(s),setTimeout(()=>s.remove(),1e3)}}setupEventListeners(){document.addEventListener("keydown",e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&(e.preventDefault(),this.keysPressed.add(e.key))}),document.addEventListener("keyup",e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&(e.preventDefault(),this.keysPressed.delete(e.key))}),document.getElementById("moveLeft").addEventListener("touchstart",()=>this.keysPressed.add("ArrowLeft")),document.getElementById("moveLeft").addEventListener("touchend",()=>this.keysPressed.delete("ArrowLeft")),document.getElementById("moveRight").addEventListener("touchstart",()=>this.keysPressed.add("ArrowRight")),document.getElementById("moveRight").addEventListener("touchend",()=>this.keysPressed.delete("ArrowRight")),document.getElementById("moveUp").addEventListener("touchstart",()=>this.keysPressed.add("ArrowUp")),document.getElementById("moveUp").addEventListener("touchend",()=>this.keysPressed.delete("ArrowUp")),document.getElementById("moveDown").addEventListener("touchstart",()=>this.keysPressed.add("ArrowDown")),document.getElementById("moveDown").addEventListener("touchend",()=>this.keysPressed.delete("ArrowDown")),document.getElementById("shoot").addEventListener("touchstart",()=>this.keysPressed.add(" ")),document.getElementById("shoot").addEventListener("touchend",()=>this.keysPressed.delete(" "))}}document.getElementById("startGame").addEventListener("click",()=>{document.getElementById("menu").style.display="none",document.getElementById("gameContainer").style.display="block",window.game=new m});document.getElementById("credits").addEventListener("click",()=>{document.getElementById("menu").style.display="none",document.getElementById("creditsMenu").style.display="flex"});document.getElementById("backToMenu").addEventListener("click",()=>{document.getElementById("creditsMenu").style.display="none",document.getElementById("menu").style.display="flex"});
